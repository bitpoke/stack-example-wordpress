window.wc&&window.wc.wcSettings&&window.wc.wcSettings.allSettings&&window.wc.wcSettings.allSettings.isCheckoutBlock||function(){function e(e,t){const s=window.wc.addressAutocomplete.serverProviders;for(const r of s){const s=window.wc.addressAutocomplete.providers[r.id];if(s&&s.canSearch(e)){window.wc.addressAutocomplete.activeProvider[t]=s;const e=document.getElementById(`${t}_address_1`);if(e){const t=e.closest(".woocommerce-input-wrapper");t&&t.classList.add("autocomplete-available"),e.setAttribute("role","combobox"),e.setAttribute("aria-autocomplete","list"),e.setAttribute("aria-expanded","false"),e.setAttribute("aria-haspopup","listbox")}return}}window.wc.addressAutocomplete.activeProvider[t]=null;const r=document.getElementById(`${t}_address_1`);if(r){const e=r.closest(".woocommerce-input-wrapper");e&&e.classList.remove("autocomplete-available"),r.removeAttribute("role"),r.removeAttribute("aria-autocomplete"),r.removeAttribute("aria-expanded"),r.removeAttribute("aria-haspopup"),r.removeAttribute("aria-activedescendant"),r.removeAttribute("aria-owns"),r.removeAttribute("aria-controls")}}document.addEventListener("DOMContentLoaded",function(){const t=["billing","shipping"],s={},r={},o={};let n,i={};const a={};function d(e){s[e]={},s[e].address_1=document.getElementById(`${e}_address_1`),s[e].address_2=document.getElementById(`${e}_address_2`),s[e].city=document.getElementById(`${e}_city`),s[e].country=document.getElementById(`${e}_country`),s[e].postcode=document.getElementById(`${e}_postcode`),s[e].state=document.getElementById(`${e}_state`)}function c(e,t=!0){if("none"!==e.getAttribute("autocomplete"))return;const s=e.getAttribute("data-original-autocomplete")||"address-line1";e.setAttribute("autocomplete",s),e.setAttribute("data-lpignore","false"),e.setAttribute("data-op-ignore","false"),e.setAttribute("data-1p-ignore","false");const r=e.parentElement;if(r){const s=e.value;e.setAttribute("data-autocomplete-manipulating","true"),r.appendChild(r.removeChild(e)),e.value!==s&&(e.value=s),requestAnimationFrame(function(){requestAnimationFrame(function(){e.removeAttribute("data-autocomplete-manipulating")})}),t&&e.focus()}}function u(e){const t=document.implementation.createHTMLDocument("");return t.body.innerHTML=e,t.body.textContent||""}async function l(e,t,n){const d=u(e);if(d!==e&&console.warn("Input was sanitized for security"),!s[n]||!s[n].address_1)return;if(!o[n]||!r[n])return;const l=s[n].address_1,f=o[n],v=r[n];if(d.length<3)return m(n),void c(l);if(!window.wc.addressAutocomplete.activeProvider[n])return m(n),void c(l);try{const e=await window.wc.addressAutocomplete.activeProvider[n].search(d,t,n);if(!Array.isArray(e))return console.error("Invalid suggestions response - not an array"),void m(n);const r=5,o=e.slice(0,r);if(0===o.length)return void m(n);if(f.innerHTML="",o.forEach((e,t)=>{const s=document.createElement("li");s.setAttribute("role","option"),s.setAttribute("aria-label",e.label),s.id=`suggestion-item-${n}-${t}`,s.dataset.id=e.id,s.textContent="",function(e,t){const s=u(e),r=[];let o=0;return Array.isArray(t)?(t.filter(e=>e&&"number"==typeof e.offset&&"number"==typeof e.length&&e.offset>=0&&e.length>0&&e.offset+e.length<=s.length).forEach(e=>{e.offset>o&&r.push(document.createTextNode(s.slice(o,e.offset)));const t=document.createElement("strong");t.textContent=s.slice(e.offset,e.offset+e.length),r.push(t),o=e.offset+e.length}),o<s.length&&r.push(document.createTextNode(s.slice(o))),r):(r.push(document.createTextNode(s)),r)}(e.label,e.matchedSubstrings||[]).forEach(e=>s.appendChild(e)),s.addEventListener("click",async function(){m(n),await p(n,this.dataset.id),l.focus()}),s.addEventListener("mouseenter",function(){g(n,t)}),f.appendChild(s)}),"undefined"!=typeof DOMPurify&&"function"==typeof DOMPurify.sanitize){const e=window.wc.addressAutocomplete.activeProvider[n];if(e&&e.id){const t=window.wc.addressAutocomplete.getServerProvider(e.id);if(t&&"string"==typeof t.branding_html?t.branding_html.trim():""){let e=v.querySelector(".woocommerce-address-autocomplete-branding");e||((e=document.createElement("div")).className="woocommerce-address-autocomplete-branding",v.appendChild(e));const s=DOMPurify.sanitize(t.branding_html,{ALLOWED_TAGS:["img","span","div","a","b","i","em","strong","br"],ALLOWED_ATTR:["href","target","rel","src","alt","style","class","id","width","height"],ALLOW_DATA_ATTR:!1});e.innerHTML=s,e.style.display="flex",e.removeAttribute("aria-hidden")}}}!function(e){if("none"===e.getAttribute("autocomplete"))return;const t=e.getAttribute("autocomplete")||"";e.setAttribute("data-original-autocomplete",t),e.setAttribute("autocomplete","none"),e.setAttribute("data-lpignore","true"),e.setAttribute("data-op-ignore","true"),e.setAttribute("data-1p-ignore","true");const s=e.parentElement;if(s){const t=e.value;e.setAttribute("data-autocomplete-manipulating","true"),s.appendChild(s.removeChild(e)),e.value!==t&&(e.value=t),setTimeout(function(){e.removeAttribute("data-autocomplete-manipulating")},10),e.focus()}}(l),v.style.display="block",v.style.marginTop=s[n].address_1.offsetHeight+"px",l.setAttribute("aria-expanded","true"),f.id=`address_suggestions_${n}_list`,l.setAttribute("aria-controls",`address_suggestions_${n}_list`),i[n]=-1,a[n]||(a[n]=function(){setTimeout(()=>{m(n),c(l,!1)},200)},l.addEventListener("blur",a[n]))}catch(y){console.error("Address search error:",y),m(n),c(l)}}function m(e){if(!s[e]||!s[e].address_1)return;if(!o[e]||!r[e])return;const t=o[e],n=r[e],d=s[e].address_1;t.innerHTML="";const c=n.querySelector(".woocommerce-address-autocomplete-branding");c&&(c.style.display="none",c.setAttribute("aria-hidden","true")),n.style.display="none",d.setAttribute("aria-expanded","false"),d.removeAttribute("aria-activedescendant"),d.removeAttribute("aria-controls"),i[e]=-1,a[e]&&(d.removeEventListener("blur",a[e]),delete a[e])}t.forEach(t=>{d(t);const n=s[t].address_1,a=s[t].country;if(n){if(!document.getElementById(`address_suggestions_${t}`)){const e=document.createElement("div");e.id=`address_suggestions_${t}`,e.className="woocommerce-address-suggestions",e.style.display="none",e.setAttribute("role","region"),e.setAttribute("aria-live","polite");const s=document.createElement("ul");s.className="suggestions-list",s.setAttribute("role","listbox"),s.setAttribute("aria-label","Address suggestions"),e.appendChild(s),n.parentNode.insertBefore(e,n.nextSibling);const r=document.createElement("div");r.className="address-search-icon",n.parentNode.appendChild(r)}r[t]=document.getElementById(`address_suggestions_${t}`),o[t]=r[t].querySelector(".suggestions-list"),i[t]=-1}if(a){e(a.value,t);const o=function(){if(d(t),e(a.value,t),s[t].address_1&&(m(t),r[t])){const e=r[t].querySelector(".woocommerce-address-autocomplete-branding");e&&e.remove()}};a.addEventListener("change",o),window.jQuery&&window.jQuery(a).select2&&window.jQuery(a).on("select2:select",o)}});const f=(e,t)=>{e&&(e.value=t,e.dispatchEvent(new Event("change")),window.jQuery&&window.jQuery(e).hasClass("select2-hidden-accessible")&&window.jQuery(e).trigger("change"))};async function p(e,t){let r;try{r=await window.wc.addressAutocomplete.activeProvider[e].select(t)}catch(o){return void console.error("Error selecting address from provider",window.wc.addressAutocomplete.activeProvider[e].id,o)}"object"==typeof r&&null!==r&&r&&s[e]&&(r.country&&f(s[e].country,r.country),r.address_1&&f(s[e].address_1,r.address_1),n&&clearTimeout(n),n=setTimeout(function(){if(d(e),s[e]){if(r.address_2)f(s[e].address_2,r.address_2);else{const t=s[e].address_2;t&&t.value&&f(t,"")}if(r.city)f(s[e].city,r.city);else{const t=s[e].city;t&&t.value&&f(t,"")}if(r.postcode)f(s[e].postcode,r.postcode);else{const t=s[e].postcode;t&&t.value&&f(t,"")}if(r.state)f(s[e].state,r.state);else{const t=s[e].state;t&&t.value&&f(t,"")}}},50))}function g(e,t){if(!s[e]||!s[e].address_1)return;if(!o[e])return;const r=o[e],n=s[e].address_1,a=r.querySelector("li.active");a&&(a.classList.remove("active"),a.setAttribute("aria-selected","false"));const d=r.querySelector(`li#suggestion-item-${e}-${t}`);d&&(d.classList.add("active"),d.setAttribute("aria-selected","true"),n.setAttribute("aria-activedescendant",d.id),i[e]=t)}t.forEach(e=>{if(!s[e])return;const t=s[e].address_1,n=s[e].country;t&&n&&(t.addEventListener("input",function(){if(o[e]){const s=o[e].querySelector("li.active");s&&(s.classList.remove("active"),s.setAttribute("aria-selected","false")),t.removeAttribute("aria-activedescendant"),i[e]=-1}l(this.value,n.value,e)}),t.addEventListener("keydown",async function(s){if(!o[e]||!r[e])return;const n=o[e].querySelectorAll("li");if(0===n.length||"none"===r[e].style.display)return;let a=i[e];if("ArrowDown"===s.key)s.preventDefault(),a=(i[e]+1)%n.length,g(e,a);else if("ArrowUp"===s.key)s.preventDefault(),a=(i[e]-1+n.length)%n.length,g(e,a);else if("Enter"===s.key){if(i[e]>-1){s.preventDefault();const r=o[e].querySelector(`li#suggestion-item-${e}-${i[e]}`);if(!r||!r.dataset||!r.dataset.id)return m(e),void c(t);m(e),c(t),await p(e,r.dataset.id),t.focus()}}else"Escape"===s.key&&(m(e),c(t))}))}),document.addEventListener("click",function(e){t.forEach(t=>{if(!s[t]||!s[t].address_1)return;if(!r[t])return;const o=e.target;o===r[t]||r[t].contains(o)||o===s[t].address_1||(m(t),s[t]&&s[t].address_1&&c(s[t].address_1,!1))})})})}();