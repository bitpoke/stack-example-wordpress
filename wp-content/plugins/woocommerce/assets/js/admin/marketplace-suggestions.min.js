!function(t,e,s){t(function(){if(void 0!==e){window.wcTracks=window.wcTracks||{},window.wcTracks.recordEvent=window.wcTracks.recordEvent||function(){};var a=!1;e.suggestions_data&&(!function(s){var n=[],o=5;if(e.suggestions_data&&e.suggestions_data[0]&&e.suggestions_data[0]["recommendations-count"]){var d=e.suggestions_data[0]["recommendations-count"];"number"==typeof d&&d>0&&d<=50&&(o=Math.floor(d))}t(".marketplace-suggestions-container").each(function(){var r=this.dataset.marketplaceSuggestionsContext,d=function(t,s){var a=_.filter(t,function(t){return _.isArray(t.context)?_.contains(t.context,s):s===t.context});return a=_.filter(a,function(t){return!_.contains(e.dismissed_suggestions,t.slug)}),a=_.filter(a,function(t){return!_.contains(e.active_plugins,t.product)}),a=_.filter(a,function(t){return!t["show-if-active"]||_.intersection(e.active_plugins,t["show-if-active"]).length>0})}(s,r),u=_.sample(d,o);for(var l in u){var g=u[l]["link-text"],p=!0;u[l]["link-text"]&&(g=u[l]["link-text"],p=!1);var m=!0;!1===u[l]["allow-dismiss"]&&(m=!1);var f=i(r,u[l].product,u[l].promoted,u[l].slug,u[l].icon,u[l].title,u[l].copy,u[l].url,u[l]["iam-url"]||"",g,p,m);t(this).append(f),t(this).addClass("showing-suggestion"),n.push(r),c(r)||window.wcTracks.recordEvent("marketplace_suggestion_displayed",{suggestion_slug:u[l].slug,context:r,product:u[l].product||"",promoted:u[l].promoted||"",target:u[l].url||""})}t("ul.product_data_tabs li.marketplace-suggestions_options a").on("click",function(t){if(t.preventDefault(),"#marketplace_suggestions"!==a&&c(r))for(var e in u)window.wcTracks.recordEvent("marketplace_suggestion_displayed",{suggestion_slug:u[e].slug,context:r,product:u[e].product||"",promoted:u[e].promoted||"",target:u[e].url||""})})}),function(e){var s=_.intersection(e,["products-list-empty-body","orders-list-empty-body"]).length>0;s&&(t("#screen-meta-links").hide(),t("#wpfooter").hide()),s||(t('.marketplace-suggestions-container[data-marketplace-suggestions-context="products-list-empty-header"]').hide(),t('.marketplace-suggestions-container[data-marketplace-suggestions-context="products-list-empty-footer"]').hide(),t('.marketplace-suggestions-container[data-marketplace-suggestions-context="orders-list-empty-header"]').hide(),t('.marketplace-suggestions-container[data-marketplace-suggestions-context="orders-list-empty-footer"]').hide())}(n),r()}(e.suggestions_data),t("ul.product_data_tabs").on("click","li a",function(e){e.preventDefault(),a=t(this).attr("href")})),t("a.marketplace-suggestion-manage-link").on("click",function(){window.wcTracks.recordEvent("marketplace_suggestions_manage_clicked")})}function n(a,n,o,i,c){var d=document.createElement("a");return d.classList.add("suggestion-dismiss"),d.setAttribute("title",e.i18n_marketplace_suggestions_dismiss_tooltip),d.setAttribute("href","#"),d.onclick=function(d){d.preventDefault(),function(a,n,o,i,c){if(t("[data-suggestion-slug="+c+"]").fadeOut(function(){t(this).remove(),r()}),jQuery.post(s,{action:"woocommerce_add_dismissed_marketplace_suggestion",_wpnonce:e.dismiss_suggestion_nonce,slug:c}),_.contains(["products-list-inline"],a)){var d="woocommerce_snooze_suggestions__"+a;Cookies.set(d,"true",{expires:2});var u="woocommerce_dismissed_suggestions__"+a,l=parseInt(Cookies.get(u),10)||0;Cookies.set(u,l+1,{expires:31})}window.wcTracks.recordEvent("marketplace_suggestion_dismissed",{suggestion_slug:c,context:a,product:n||"",promoted:o||"",target:i||""})}(a,n,o,i,c)},d}function o(t,s,a,n,o,i,r,c){var d=document.createElement("a"),u=function(t,s){var a=e.in_app_purchase_params;a.utm_source="unknown",a.utm_campaign="marketplacesuggestions",a.utm_medium="product";var n=_.findKey({productstable:["products-list-inline"],productsempty:["products-list-empty-header","products-list-empty-footer","products-list-empty-body"],ordersempty:["orders-list-empty-header","orders-list-empty-footer","orders-list-empty-body"],editproduct:["product-edit-meta-tab-header","product-edit-meta-tab-footer","product-edit-meta-tab-body"]},function(e){return _.contains(e,t)});return n&&(a.utm_source=n),s+"?"+jQuery.param(a)}(t,o),l=Boolean(i),g=l?function(t){if(!e.admin_base_url||!t||"string"!=typeof t)return"";var s="/"===t.charAt(0)?t.slice(1):t;return e.admin_base_url+s}(i):u;d.setAttribute("href",g);if(_.includes(["product-edit-meta-tab-header","product-edit-meta-tab-footer","product-edit-meta-tab-body","products-list-empty-footer"],t)&&d.setAttribute("target","blank"),d.textContent=r,d.onclick=function(){window.wcTracks.recordEvent("marketplace_suggestion_clicked",{suggestion_slug:n,context:t,product:s||"",promoted:a||"",target:g||""})},c)d.classList.add("button");else if(d.classList.add("linkout"),!l){var p=document.createElement("span");p.classList.add("dashicons","dashicons-external"),d.appendChild(p)}return d}function i(t,s,a,i,r,c,d,u,l,g,p,m){var _=document.createElement("div");_.classList.add("marketplace-suggestion-container"),_.dataset.suggestionSlug=i;var f=function(t){if(!t)return null;var e=document.createElement("img");return e.src=t,e.classList.add("marketplace-suggestion-icon"),e}(r);return f&&_.appendChild(f),_.appendChild(function(t,s,a){var n=document.createElement("div");if(n.classList.add("marketplace-suggestion-container-content"),s){var o=document.createElement("h4");o.textContent=s,n.appendChild(o)}if(a){var i=document.createElement("p");i.textContent=a,n.appendChild(i)}if(-1!==["product-edit-empty-footer-browse-all","product-edit-meta-tab-footer-browse-all"].indexOf(t)){n.classList.add("has-manage-link");var r=document.createElement("a");r.classList.add("marketplace-suggestion-manage-link","linkout"),r.setAttribute("href",e.manage_suggestions_url),r.textContent=e.i18n_marketplace_suggestions_manage_suggestions,n.appendChild(r)}return n}(i,c,d)),_.appendChild(function(t,s,a,i,r,c,d,u,l){var g=document.createElement("div");if(d||(d=e.i18n_marketplace_suggestions_default_cta),g.classList.add("marketplace-suggestion-container-cta"),r&&d){var p=o(t,s,a,i,r,c,d,u);g.appendChild(p)}return l&&g.appendChild(n(t,s,a,r,i)),g}(t,s,a,i,u,l,g,p,m)),_}function r(){if(0>=t('.marketplace-suggestions-container[data-marketplace-suggestions-context="product-edit-meta-tab-body"]').children().length){var e='.marketplace-suggestions-container[data-marketplace-suggestions-context="product-edit-meta-tab-body"]';e+=', .marketplace-suggestions-container[data-marketplace-suggestions-context="product-edit-meta-tab-header"]',t(e+=', .marketplace-suggestions-container[data-marketplace-suggestions-context="product-edit-meta-tab-footer"]').fadeOut({complete:function(){t(".marketplace-suggestions-metabox-nosuggestions-placeholder").fadeIn()}})}}function c(t){return _.includes(["product-edit-meta-tab-header","product-edit-meta-tab-body","product-edit-meta-tab-footer"],t)}})}(jQuery,marketplace_suggestions,ajaxurl);