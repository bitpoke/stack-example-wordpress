"use strict";(globalThis.webpackChunk_wcAdmin_webpackJsonp=globalThis.webpackChunk_wcAdmin_webpackJsonp||[]).push([[8597],{83619:(e,t,r)=>{r.d(t,{Z:()=>a});var s=r(69307),o=r(70444);const a=(0,s.createElement)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,s.createElement)(o.Path,{d:"M10.6 6L9.4 7l4.6 5-4.6 5 1.2 1 5.4-6z"}))},93098:(e,t,r)=>{r.r(t),r.d(t,{StoreAlerts:()=>y,default:()=>k});var s=r(69307),o=r(65736),a=r(55609),n=r(7829),l=r(76357),i=r(94333),c=r(9818),m=r(76292),d=r.n(m),u=r(23374),p=r(70261),h=r(70048),_=r(83619),g=r(67221),w=r(14599),E=r(14812),N=r(10431),v=r(346),A=r(7862),b=r.n(A);class x extends s.Component{render(){const{hasMultipleAlerts:e}=this.props;return(0,s.createElement)(a.Card,{className:"woocommerce-store-alerts is-loading","aria-hidden":!0,size:null},(0,s.createElement)(a.CardHeader,{isBorderless:!0},(0,s.createElement)("span",{className:"is-placeholder"}),e&&(0,s.createElement)("span",{className:"is-placeholder"})),(0,s.createElement)(a.CardBody,null,(0,s.createElement)("div",{className:"woocommerce-store-alerts__message"},(0,s.createElement)("span",{className:"is-placeholder"}),(0,s.createElement)("span",{className:"is-placeholder"}))),(0,s.createElement)(a.CardFooter,{isBorderless:!0},(0,s.createElement)("span",{className:"is-placeholder"})))}}const S=x;x.propTypes={hasMultipleAlerts:b().bool},x.defaultProps={hasMultipleAlerts:!1};var C=r(17062),f=r(53736);class y extends s.Component{constructor(e){super(e),this.state={currentIndex:0,alerts:e.alerts},this.previousAlert=this.previousAlert.bind(this),this.nextAlert=this.nextAlert.bind(this)}componentDidUpdate(e){e.alerts!==this.props.alerts&&this.setState({alerts:this.props.alerts})}previousAlert(e){e?.stopPropagation();const{currentIndex:t}=this.state;t>0&&this.setState({currentIndex:t-1})}nextAlert(e){e.stopPropagation();const t=this.getAlerts(),{currentIndex:r}=this.state;r<t.length-1&&this.setState({currentIndex:r+1})}renderActions(e){const{triggerNoteAction:t,updateNote:r,createNotice:n}=this.props,l=e.actions.map((r=>(0,s.createElement)(a.Button,{key:r.name,isPrimary:r.primary,isSecondary:!r.primary,href:r.url||void 0,onClick:async s=>{const a=s.currentTarget.getAttribute("href");s.preventDefault(),this.previousAlert();try{await t(e.id,r.id),a&&"#"!==a&&(0,N.parseAdminUrl)(a).href!==window.location.href&&(0,N.navigateTo)({url:a})}catch(e){throw n("error",(0,o.__)("Something went wrong while triggering this note's action.","woocommerce")),e}}},r.label))),i=[{value:d()().add(4,"hours").unix().toString(),label:(0,o.__)("Later Today","woocommerce")},{value:d()().add(1,"day").hour(9).minute(0).second(0).millisecond(0).unix().toString(),label:(0,o.__)("Tomorrow","woocommerce")},{value:d()().add(1,"week").hour(9).minute(0).second(0).millisecond(0).unix().toString(),label:(0,o.__)("Next Week","woocommerce")},{value:d()().add(1,"month").hour(9).minute(0).second(0).millisecond(0).unix().toString(),label:(0,o.__)("Next Month","woocommerce")}],c=e.is_snoozable&&(0,s.createElement)(a.SelectControl,{className:"woocommerce-store-alerts__snooze",options:[{label:(0,o.__)("Remind Me Later","woocommerce"),value:"0"},...i],onChange:t=>{if("0"===t)return;const s=i.find((e=>e.value===t));(t=>{r(e.id,{status:"snoozed",date_reminder:t.value});const s={alert_name:e.name,alert_title:e.title,snooze_duration:t.value,snooze_label:t.label};(0,w.recordEvent)("store_alert_snooze",s)})({value:t,label:s&&s.label})}});if(l||c)return(0,s.createElement)("div",{className:"woocommerce-store-alerts__actions"},l,c)}getAlerts(){return(this.state.alerts||[]).filter((e=>"unactioned"===e.status))}render(){const e=this.getAlerts(),t=(0,C.O3)("alertCount",0,(e=>parseInt(e,10)));if(t>0&&this.props.isLoading)return(0,s.createElement)(S,{hasMultipleAlerts:t>1});if(0===e.length)return null;const{currentIndex:r}=this.state,i=e.length,c=e[r],m=c.type,d=(0,n.Z)("woocommerce-store-alerts",{"is-alert-error":"error"===m,"is-alert-update":"update"===m}),g=async e=>{const t=(0,f.GG)(),{createNotice:r,removeNote:s}=this.props;(0,w.recordEvent)("inbox_action_dismiss",{note_name:e.name,note_title:e.title,note_name_dismiss_all:!1,note_name_dismiss_confirmation:!0,screen:t});const a=e.id;try{await s(a),this.setState({alerts:this.state.alerts.filter((e=>e.id!==a))}),r("success",(0,o.__)("Message dismissed","woocommerce"))}catch(e){r("error",(0,o._n)("Message could not be dismissed","Messages could not be dismissed",1,"woocommerce"))}};return(0,s.createElement)(a.Card,{className:d,size:null},(0,s.createElement)(a.Button,{className:"woocommerce-store-alerts__close",onClick:()=>g(c)},(0,s.createElement)(u.Z,{icon:p.Z})),(0,s.createElement)(a.CardHeader,{isBorderless:!0},(0,s.createElement)(E.Text,{variant:"title.medium",as:"h2",size:"24",lineHeight:"32px"},c.title),i>1&&(0,s.createElement)("div",{className:"woocommerce-store-alerts__pagination"},(0,s.createElement)(a.Button,{onClick:this.previousAlert,disabled:0===r,label:(0,o.__)("Previous Alert","woocommerce")},(0,s.createElement)(u.Z,{icon:h.Z,className:"arrow-left-icon"})),(0,s.createElement)("span",{className:"woocommerce-store-alerts__pagination-label",role:"status","aria-live":"polite"},(0,l.Z)({mixedString:(0,o.__)("{{current /}} of {{total /}}","woocommerce"),components:{current:(0,s.createElement)(s.Fragment,null,r+1),total:(0,s.createElement)(s.Fragment,null,i)}})),(0,s.createElement)(a.Button,{onClick:this.nextAlert,disabled:i-1===r,label:(0,o.__)("Next Alert","woocommerce")},(0,s.createElement)(u.Z,{icon:_.Z,className:"arrow-right-icon"})))),(0,s.createElement)(a.CardBody,null,(0,s.createElement)("div",{className:"woocommerce-store-alerts__message",dangerouslySetInnerHTML:(0,v.ZP)(c.content)})),(0,s.createElement)(a.CardFooter,{isBorderless:!0},this.renderActions(c)))}}const T={page:1,per_page:g.QUERY_DEFAULTS.pageSize,type:"error,update",status:"unactioned"},k=(0,i.compose)((0,c.withSelect)((e=>{const{getNotes:t,isResolving:r}=e(g.NOTES_STORE_NAME);return{alerts:t(T),isLoading:r("getNotes",[T])}})),(0,c.withDispatch)((e=>{const{triggerNoteAction:t,updateNote:r,removeNote:s}=e(g.NOTES_STORE_NAME),{createNotice:o}=e("core/notices");return{triggerNoteAction:t,updateNote:r,createNotice:o,removeNote:s}})))(y)}}]);