"use strict";(globalThis.webpackChunk_wcAdmin_webpackJsonp=globalThis.webpackChunk_wcAdmin_webpackJsonp||[]).push([[8597],{2514:(e,s,o)=>{o.d(s,{Z:()=>a});var t=o(70444),r=o(81514);const a=(0,r.jsx)(t.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,r.jsx)(t.Path,{d:"M14.6 7l-1.2-1L8 12l5.4 6 1.2-1-4.6-5z"})})},32196:(e,s,o)=>{o.d(s,{Z:()=>a});var t=o(70444),r=o(81514);const a=(0,r.jsx)(t.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,r.jsx)(t.Path,{d:"M10.6 6L9.4 7l4.6 5-4.6 5 1.2 1 5.4-6z"})})},40523:(e,s,o)=>{o.d(s,{t:()=>t});const t=(e,s,o)=>{const t=!o||window.wcAdminFeatures.analytics;return"two_columns"===(e||s)&&t}},68628:(e,s,o)=>{o.r(s),o.d(s,{StoreAlerts:()=>k,default:()=>z});var t=o(65736),r=o(69307),a=o(55609),n=o(80225),l=o(28302),c=o(9818),i=o(76292),d=o.n(i),m=o(59550),u=o(2514),h=o(32196),_=o(66210),p=o(67221),w=o(14599),g=o(10431),x=o(9845),j=o(69596),v=o.n(j),b=o(81514);class N extends r.Component{render(){const{hasMultipleAlerts:e,className:s}=this.props;return(0,b.jsxs)(a.Card,{className:(0,n.Z)("woocommerce-store-alerts is-loading",s),"aria-hidden":!0,size:null,children:[(0,b.jsxs)(a.CardHeader,{isBorderless:!0,children:[(0,b.jsx)("span",{className:"is-placeholder"}),e&&(0,b.jsx)("span",{className:"is-placeholder"})]}),(0,b.jsx)(a.CardBody,{children:(0,b.jsxs)("div",{className:"woocommerce-store-alerts__message",children:[(0,b.jsx)("span",{className:"is-placeholder"}),(0,b.jsx)("span",{className:"is-placeholder"})]})}),(0,b.jsx)(a.CardFooter,{isBorderless:!0,children:(0,b.jsx)("span",{className:"is-placeholder"})})]})}}const f=N;N.propTypes={hasMultipleAlerts:v().bool},N.defaultProps={hasMultipleAlerts:!1};var S=o(91978),y=o(31586),A=o(40523),C=o(21688);const L={page:1,per_page:p.QUERY_DEFAULTS.pageSize,type:"error,update",status:"unactioned"};function Z(e){return(e||[]).filter((e=>"unactioned"===e.status&&!0!==e.is_deleted))}const k=()=>{const[e,s]=(0,r.useState)(0),{alerts:o=[],isLoading:i,defaultHomescreenLayout:j}=(0,c.useSelect)((e=>{const{getNotes:s,hasFinishedResolution:o}=e(p.notesStore),{getOption:t}=e(p.optionsStore);return{alerts:Z(s(L)),isLoading:!o("getNotes",[L]),defaultHomescreenLayout:t("woocommerce_default_homepage_layout")||"single_column"}})),{triggerNoteAction:v,updateNote:N,removeNote:k}=(0,c.useDispatch)(p.notesStore),{createNotice:z}=(0,c.useDispatch)("core/notices"),B=(0,p.useUserPreferences)();function M(o){o?.stopPropagation(),e>0&&s(e-1)}const T=(0,S.O3)("alertCount",0,(e=>parseInt(e,10))),P=(0,g.isWCAdmin)(),F=P&&"homescreen"===(0,g.getScreenFromPath)(),D=(0,A.t)(B.homepage_layout,j,(0,C.vD)("setup"));if(T>0&&i)return(0,b.jsx)(f,{className:(0,n.Z)({"is-wc-admin-page":P,"is-homescreen":F,"two-columns":D&&F}),hasMultipleAlerts:T>1});if(0===o.length)return null;const E=o.length,G=o[e],H=G.type,O=(0,n.Z)("woocommerce-store-alerts",{"is-alert-error":"error"===H,"is-alert-update":"update"===H,"is-wc-admin-page":P,"is-homescreen":F,"two-columns":D&&F});return(0,b.jsxs)(a.Card,{className:O,size:null,children:[(0,b.jsxs)(a.CardHeader,{className:"woocommerce-store-alerts__header",isBorderless:!0,children:[(0,b.jsx)("span",{className:"woocommerce-store-alerts__title",children:G.title}),E>1&&(0,b.jsxs)("div",{className:"woocommerce-store-alerts__pagination",children:[(0,b.jsx)("span",{className:"woocommerce-store-alerts__pagination-label",role:"status","aria-live":"polite",children:(0,l.Z)({mixedString:(0,t.__)("{{current /}} of {{total /}}","woocommerce"),components:{current:(0,b.jsx)(r.Fragment,{children:e+1}),total:(0,b.jsx)(r.Fragment,{children:E})}})}),(0,b.jsx)(a.Button,{onClick:M,disabled:0===e,label:(0,t.__)("Previous Alert","woocommerce"),children:(0,b.jsx)(m.Z,{icon:u.Z,className:"arrow-left-icon"})}),(0,b.jsx)(a.Button,{onClick:function(t){t.stopPropagation(),e<o.length-1&&s(e+1)},disabled:E-1===e,label:(0,t.__)("Next Alert","woocommerce"),children:(0,b.jsx)(m.Z,{icon:h.Z,className:"arrow-right-icon"})})]}),(0,b.jsx)(a.Button,{className:"woocommerce-store-alerts__close",onClick:()=>(async e=>{const s=(0,y.GG)();(0,w.recordEvent)("inbox_action_dismiss",{note_name:e.name,note_title:e.title,note_name_dismiss_all:!1,note_name_dismiss_confirmation:!0,screen:s});const o=e.id;try{await k(o),z("success",(0,t.__)("Message dismissed","woocommerce"))}catch(e){z("error",(0,t._n)("Message could not be dismissed","Messages could not be dismissed",1,"woocommerce"))}})(G),children:(0,b.jsx)(m.Z,{width:"18",height:"18",icon:_.Z})})]}),(0,b.jsx)(a.CardBody,{children:(0,b.jsx)("div",{className:"woocommerce-store-alerts__message",dangerouslySetInnerHTML:(0,x.ZP)(G.content)})}),(0,b.jsx)(a.CardFooter,{isBorderless:!0,children:function(e){const s=e.actions.map(((s,o)=>{const r=0===o?"secondary":"tertiary";return(0,b.jsx)(a.Button,{variant:r,href:s.url||void 0,onClick:async o=>{const r=o.currentTarget.getAttribute("href");o.preventDefault(),M();try{await v(e.id,s.id),r&&"#"!==r&&(0,g.parseAdminUrl)(r).href!==window.location.href&&(0,g.navigateTo)({url:r})}catch(e){throw z("error",(0,t.__)("Something went wrong while triggering this note's action.","woocommerce")),e}},children:s.label},`${e.id}-${s.label}-${s.name}`)})),o=[{value:d()().add(4,"hours").unix().toString(),label:(0,t.__)("Later Today","woocommerce")},{value:d()().add(1,"day").hour(9).minute(0).second(0).millisecond(0).unix().toString(),label:(0,t.__)("Tomorrow","woocommerce")},{value:d()().add(1,"week").hour(9).minute(0).second(0).millisecond(0).unix().toString(),label:(0,t.__)("Next Week","woocommerce")},{value:d()().add(1,"month").hour(9).minute(0).second(0).millisecond(0).unix().toString(),label:(0,t.__)("Next Month","woocommerce")}],r=e.is_snoozable&&(0,b.jsx)(a.SelectControl,{className:"woocommerce-store-alerts__snooze",options:[{label:(0,t.__)("Remind Me Later","woocommerce"),value:"0"},...o],onChange:s=>{if("0"===s)return;const t=o.find((e=>e.value===s));(s=>{N(e.id,{status:"snoozed",date_reminder:s.value});const o={alert_name:e.name,alert_title:e.title,snooze_duration:s.value,snooze_label:s.label};(0,w.recordEvent)("store_alert_snooze",o)})({value:s,label:t&&t.label})}});if(s||r)return(0,b.jsxs)("div",{className:"woocommerce-store-alerts__actions",children:[s,r]})}(G)})]})},z=k},9845:(e,s,o)=>{o.d(s,{ZP:()=>n});var t=o(25209);const r=["a","b","em","i","strong","p","br"],a=["target","href","rel","name","download"],n=e=>({__html:(0,t.sanitize)(e,{ALLOWED_TAGS:r,ALLOWED_ATTR:a})})}}]);