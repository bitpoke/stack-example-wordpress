"use strict";(globalThis.webpackChunk_wcAdmin_webpackJsonp=globalThis.webpackChunk_wcAdmin_webpackJsonp||[]).push([[8597],{68628:(e,s,o)=>{o.r(s),o.d(s,{StoreAlerts:()=>y,default:()=>L});var t=o(65736),a=o(69307),r=o(55609),n=o(80225),i=o(28302),l=o(9818),c=o(76292),d=o.n(c),m=o(59550),u=o(2514),_=o(32196),h=o(66210),p=o(67221),g=o(14599),w=o(10431),x=o(9845),N=o(69596),j=o.n(N),b=o(81514);class f extends a.Component{render(){const{hasMultipleAlerts:e,className:s}=this.props;return(0,b.jsxs)(r.Card,{className:(0,n.Z)("woocommerce-store-alerts is-loading",s),"aria-hidden":!0,size:null,children:[(0,b.jsxs)(r.CardHeader,{isBorderless:!0,children:[(0,b.jsx)("span",{className:"is-placeholder"}),e&&(0,b.jsx)("span",{className:"is-placeholder"})]}),(0,b.jsx)(r.CardBody,{children:(0,b.jsxs)("div",{className:"woocommerce-store-alerts__message",children:[(0,b.jsx)("span",{className:"is-placeholder"}),(0,b.jsx)("span",{className:"is-placeholder"})]})}),(0,b.jsx)(r.CardFooter,{isBorderless:!0,children:(0,b.jsx)("span",{className:"is-placeholder"})})]})}}const v=f;f.propTypes={hasMultipleAlerts:j().bool},f.defaultProps={hasMultipleAlerts:!1};var C=o(91978),T=o(21464),S=o(74784);const k={page:1,per_page:p.QUERY_DEFAULTS.pageSize,type:"error,update",status:"unactioned"};function A(e){return(e||[]).filter((e=>"unactioned"===e.status&&!0!==e.is_deleted))}const y=()=>{const[e,s]=(0,a.useState)(0),{alerts:o=[],isLoading:c,defaultHomescreenLayout:N,taskListComplete:j,isTaskListHidden:f,isLoadingTaskLists:y}=(0,l.useSelect)((e=>{const{getNotes:s,hasFinishedResolution:o}=e(p.NOTES_STORE_NAME),{getOption:t}=e(p.OPTIONS_STORE_NAME),{getTaskList:a,hasFinishedResolution:r}=e(p.ONBOARDING_STORE_NAME);return{alerts:A(s(k)),isLoading:!o("getNotes",[k]),defaultHomescreenLayout:t("woocommerce_default_homepage_layout")||"single_column",taskListComplete:a("setup")?.isComplete,isTaskListHidden:a("setup")?.isHidden,isLoadingTaskLists:!r("getTaskLists")}})),{triggerNoteAction:L,updateNote:E,removeNote:M}=(0,l.useDispatch)(p.NOTES_STORE_NAME),{createNotice:O}=(0,l.useDispatch)("core/notices"),B=(0,p.useUserPreferences)();function Z(o){o?.stopPropagation(),e>0&&s(e-1)}if(y)return null;const z=(0,C.O3)("alertCount",0,(e=>parseInt(e,10))),R=(0,w.isWCAdmin)(),F=R&&"homescreen"===(0,w.getScreenFromPath)(),H=(0,S.tv)(B.homepage_layout,N,j,f);if(z>0&&c)return(0,b.jsx)(v,{className:(0,n.Z)({"is-wc-admin-page":R,"is-homescreen":F,"two-columns":H&&F}),hasMultipleAlerts:z>1});if(0===o.length)return null;const P=o.length,D=o[e],I=D.type,U=(0,n.Z)("woocommerce-store-alerts",{"is-alert-error":"error"===I,"is-alert-update":"update"===I,"is-wc-admin-page":R,"is-homescreen":F,"two-columns":H&&F});return(0,b.jsxs)(r.Card,{className:U,size:null,children:[(0,b.jsxs)(r.CardHeader,{className:"woocommerce-store-alerts__header",isBorderless:!0,children:[(0,b.jsx)("span",{className:"woocommerce-store-alerts__title",children:D.title}),P>1&&(0,b.jsxs)("div",{className:"woocommerce-store-alerts__pagination",children:[(0,b.jsx)("span",{className:"woocommerce-store-alerts__pagination-label",role:"status","aria-live":"polite",children:(0,i.Z)({mixedString:(0,t.__)("{{current /}} of {{total /}}","woocommerce"),components:{current:(0,b.jsx)(a.Fragment,{children:e+1}),total:(0,b.jsx)(a.Fragment,{children:P})}})}),(0,b.jsx)(r.Button,{onClick:Z,disabled:0===e,label:(0,t.__)("Previous Alert","woocommerce"),children:(0,b.jsx)(m.Z,{icon:u.Z,className:"arrow-left-icon"})}),(0,b.jsx)(r.Button,{onClick:function(t){t.stopPropagation(),e<o.length-1&&s(e+1)},disabled:P-1===e,label:(0,t.__)("Next Alert","woocommerce"),children:(0,b.jsx)(m.Z,{icon:_.Z,className:"arrow-right-icon"})})]}),(0,b.jsx)(r.Button,{className:"woocommerce-store-alerts__close",onClick:()=>(async e=>{const s=(0,T.GG)();(0,g.recordEvent)("inbox_action_dismiss",{note_name:e.name,note_title:e.title,note_name_dismiss_all:!1,note_name_dismiss_confirmation:!0,screen:s});const o=e.id;try{await M(o),O("success",(0,t.__)("Message dismissed","woocommerce"))}catch(e){O("error",(0,t._n)("Message could not be dismissed","Messages could not be dismissed",1,"woocommerce"))}})(D),children:(0,b.jsx)(m.Z,{width:"18",height:"18",icon:h.Z})})]}),(0,b.jsx)(r.CardBody,{children:(0,b.jsx)("div",{className:"woocommerce-store-alerts__message",dangerouslySetInnerHTML:(0,x.ZP)(D.content)})}),(0,b.jsx)(r.CardFooter,{isBorderless:!0,children:function(e){const s=e.actions.map(((s,o)=>{const a=0===o?"secondary":"tertiary";return(0,b.jsx)(r.Button,{variant:a,href:s.url||void 0,onClick:async o=>{const a=o.currentTarget.getAttribute("href");o.preventDefault(),Z();try{await L(e.id,s.id),a&&"#"!==a&&(0,w.parseAdminUrl)(a).href!==window.location.href&&(0,w.navigateTo)({url:a})}catch(e){throw O("error",(0,t.__)("Something went wrong while triggering this note's action.","woocommerce")),e}},children:s.label},`${e.id}-${s.label}-${s.name}`)})),o=[{value:d()().add(4,"hours").unix().toString(),label:(0,t.__)("Later Today","woocommerce")},{value:d()().add(1,"day").hour(9).minute(0).second(0).millisecond(0).unix().toString(),label:(0,t.__)("Tomorrow","woocommerce")},{value:d()().add(1,"week").hour(9).minute(0).second(0).millisecond(0).unix().toString(),label:(0,t.__)("Next Week","woocommerce")},{value:d()().add(1,"month").hour(9).minute(0).second(0).millisecond(0).unix().toString(),label:(0,t.__)("Next Month","woocommerce")}],a=e.is_snoozable&&(0,b.jsx)(r.SelectControl,{className:"woocommerce-store-alerts__snooze",options:[{label:(0,t.__)("Remind Me Later","woocommerce"),value:"0"},...o],onChange:s=>{if("0"===s)return;const t=o.find((e=>e.value===s));(s=>{E(e.id,{status:"snoozed",date_reminder:s.value});const o={alert_name:e.name,alert_title:e.title,snooze_duration:s.value,snooze_label:s.label};(0,g.recordEvent)("store_alert_snooze",o)})({value:s,label:t&&t.label})}});if(s||a)return(0,b.jsxs)("div",{className:"woocommerce-store-alerts__actions",children:[s,a]})}(D)})]})},L=y}}]);