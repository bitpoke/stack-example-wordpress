"use strict";(globalThis.webpackChunk_wcAdmin_webpackJsonp=globalThis.webpackChunk_wcAdmin_webpackJsonp||[]).push([[4011],{41351:(e,o,t)=>{t.d(o,{O3:()=>u,be:()=>l,u8:()=>p});var r=t(65736),n=t(92694),s=t(9818),c=t(75606),a=t(45719);const{addCesSurveyForAnalytics:i}=(0,s.dispatch)(c.STORE_KEY),u=(0,n.applyFilters)("woocommerce_admin_coupons_report_charts",[{key:"orders_count",label:(0,r.__)("Discounted orders","woocommerce"),order:"desc",orderby:"orders_count",type:"number"},{key:"amount",label:(0,r.__)("Amount","woocommerce"),order:"desc",orderby:"amount",type:"currency"}]),l=(0,n.applyFilters)("woocommerce_admin_coupon_report_advanced_filters",{filters:{},title:(0,r._x)("Coupons match <select/> filters","A sentence describing filters for Coupons. See screen shot for context: https://cloudup.com/cSsUY9VeCVJ","woocommerce")}),m=[{label:(0,r.__)("All coupons","woocommerce"),value:"all"},{label:(0,r.__)("Single coupon","woocommerce"),value:"select_coupon",chartMode:"item-comparison",subFilters:[{component:"Search",value:"single_coupon",chartMode:"item-comparison",path:["select_coupon"],settings:{type:"coupons",param:"coupons",getLabels:a.hQ,labels:{placeholder:(0,r.__)("Type to search for a coupon","woocommerce"),button:(0,r.__)("Single Coupon","woocommerce")}}}]},{label:(0,r.__)("Comparison","woocommerce"),value:"compare-coupons",settings:{type:"coupons",param:"coupons",getLabels:a.hQ,labels:{title:(0,r.__)("Compare Coupon Codes","woocommerce"),update:(0,r.__)("Compare","woocommerce"),helpText:(0,r.__)("Check at least two coupon codes below to compare","woocommerce")},onClick:i}}];Object.keys(l.filters).length&&m.push({label:(0,r.__)("Advanced filters","woocommerce"),value:"advanced"});const p=(0,n.applyFilters)("woocommerce_admin_coupons_report_filters",[{label:(0,r.__)("Show","woocommerce"),staticParams:["chartType","paged","per_page"],param:"filter",showFilters:()=>!0,filters:m}])},51548:(e,o,t)=>{t.r(o),t.d(o,{default:()=>x});var r=t(69307),n=t(69596),s=t.n(n),c=t(65736),a=t(41351),i=t(92819),u=t(86020),l=t(10431),m=t(81595),p=t(81921),d=t(17844),_=t(66777),y=t(91978),h=t(81514);class b extends r.Component{constructor(){super(),this.getHeadersContent=this.getHeadersContent.bind(this),this.getRowsContent=this.getRowsContent.bind(this),this.getSummary=this.getSummary.bind(this)}getHeadersContent(){return[{label:(0,c.__)("Coupon code","woocommerce"),key:"code",required:!0,isLeftAligned:!0,isSortable:!0},{label:(0,c.__)("Orders","woocommerce"),key:"orders_count",required:!0,defaultSort:!0,isSortable:!0,isNumeric:!0},{label:(0,c.__)("Amount discounted","woocommerce"),key:"amount",isSortable:!0,isNumeric:!0},{label:(0,c.__)("Created","woocommerce"),key:"created"},{label:(0,c.__)("Expires","woocommerce"),key:"expires"},{label:(0,c.__)("Type","woocommerce"),key:"type"}]}getRowsContent(e){const{query:o}=this.props,t=(0,l.getPersistedQuery)(o),r=(0,y.O3)("dateFormat",p.defaultTableDateFormat),{formatAmount:n,formatDecimal:s,getCurrencyConfig:a}=this.context;return(0,i.map)(e,(e=>{const{amount:o,coupon_id:i,orders_count:p}=e,d=e.extended_info||{},{code:_,date_created:y,date_expires:b,discount_type:g}=d,C=i>0?(0,l.getNewPath)(t,"/analytics/coupons",{filter:"single_coupon",coupons:i}):null,w=null===C?_:(0,h.jsx)(u.Link,{href:C,type:"wc-admin",children:_}),f=i>0?(0,l.getNewPath)(t,"/analytics/orders",{filter:"advanced",coupon_includes:i}):null;return[{display:w,value:_},{display:null===f?p:(0,h.jsx)(u.Link,{href:f,type:"wc-admin",children:(0,m.formatValue)(a(),"number",p)}),value:p},{display:n(o),value:s(o)},{display:y?(0,h.jsx)(u.Date,{date:y,visibleFormat:r}):(0,c.__)("N/A","woocommerce"),value:y},{display:b?(0,h.jsx)(u.Date,{date:b,visibleFormat:r}):(0,c.__)("N/A","woocommerce"),value:b},{display:this.getCouponType(g),value:g}]}))}getSummary(e){const{coupons_count:o=0,orders_count:t=0,amount:r=0}=e,{formatAmount:n,getCurrencyConfig:s}=this.context,a=s();return[{label:(0,c._n)("Coupon","Coupons",o,"woocommerce"),value:(0,m.formatValue)(a,"number",o)},{label:(0,c._n)("Order","Orders",t,"woocommerce"),value:(0,m.formatValue)(a,"number",t)},{label:(0,c.__)("Amount discounted","woocommerce"),value:n(r)}]}getCouponType(e){return{percent:(0,c.__)("Percentage","woocommerce"),fixed_cart:(0,c.__)("Fixed cart","woocommerce"),fixed_product:(0,c.__)("Fixed product","woocommerce")}[e]||(0,c.__)("N/A","woocommerce")}render(){const{advancedFilters:e,filters:o,isRequesting:t,query:r}=this.props;return(0,h.jsx)(_.Z,{compareBy:"coupons",endpoint:"coupons",getHeadersContent:this.getHeadersContent,getRowsContent:this.getRowsContent,getSummary:this.getSummary,summaryFields:["coupons_count","orders_count","amount"],isRequesting:t,itemIdField:"coupon_id",query:r,searchBy:"coupons",tableQuery:{orderby:r.orderby||"orders_count",order:r.order||"desc",extended_info:!0},title:(0,c.__)("Coupons","woocommerce"),columnPrefsKey:"coupons_report_columns",filters:o,advancedFilters:e})}}b.contextType=d.CurrencyContext;const g=b;var C=t(67327),w=t(62671),f=t(17853),v=t(56739);class A extends r.Component{getChartMeta(){const{query:e}=this.props,o="compare-coupons"===e.filter&&e.coupons&&e.coupons.split(",").length>1?"item-comparison":"time-comparison";return{itemsLabel:(0,c.__)("%d coupons","woocommerce"),mode:o}}render(){const{isRequesting:e,query:o,path:t}=this.props,{mode:n,itemsLabel:s}=this.getChartMeta(),c={...o};return"item-comparison"===n&&(c.segmentby="coupon"),(0,h.jsxs)(r.Fragment,{children:[(0,h.jsx)(v.Z,{query:o,path:t,filters:a.u8,advancedFilters:a.be,report:"coupons"}),(0,h.jsx)(f.Z,{charts:a.O3,endpoint:"coupons",query:c,selectedChart:(0,C.Z)(o.chart,a.O3),filters:a.u8,advancedFilters:a.be}),(0,h.jsx)(w.Z,{charts:a.O3,filters:a.u8,advancedFilters:a.be,mode:n,endpoint:"coupons",path:t,query:c,isRequesting:e,itemsLabel:s,selectedChart:(0,C.Z)(o.chart,a.O3)}),(0,h.jsx)(g,{isRequesting:e,query:o,filters:a.u8,advancedFilters:a.be})]})}}A.propTypes={query:s().object.isRequired};const x=A},22575:(e,o,t)=>{t.d(o,{I:()=>n});var r=t(65736);function n(e){return[e.country,e.state,e.name||(0,r.__)("TAX","woocommerce"),e.priority].map((e=>e.toString().toUpperCase().trim())).filter(Boolean).join("-")}},45719:(e,o,t)=>{t.d(o,{FI:()=>b,V1:()=>g,YC:()=>d,hQ:()=>_,jk:()=>y,oC:()=>h,qc:()=>p,uC:()=>C});var r=t(65736),n=t(96483),s=t(86989),c=t.n(s),a=t(92819),i=t(10431),u=t(67221),l=t(22575),m=t(91978);function p(e,o=a.identity){return function(t="",r){const s="function"==typeof e?e(r):e,a=(0,i.getIdsFromQuery)(t);if(a.length<1)return Promise.resolve([]);const u={include:a.join(","),per_page:a.length};return c()({path:(0,n.addQueryArgs)(s,u)}).then((e=>e.map(o)))}}p(u.NAMESPACE+"/products/attributes",(e=>({key:e.id,label:e.name})));const d=p(u.NAMESPACE+"/products/categories",(e=>({key:e.id,label:e.name}))),_=p(u.NAMESPACE+"/coupons",(e=>({key:e.id,label:e.code}))),y=p(u.NAMESPACE+"/customers",(e=>({key:e.id,label:e.name}))),h=p(u.NAMESPACE+"/products",(e=>({key:e.id,label:e.name}))),b=p(u.NAMESPACE+"/taxes",(e=>({key:e.id,label:(0,l.I)(e)})));function g({attributes:e,name:o}){const t=(0,m.O3)("variationTitleAttributesSeparator"," - ");if(o&&o.indexOf(t)>-1)return o;const n=(e||[]).map((({name:e,option:o})=>(o||(e=e.charAt(0).toUpperCase()+e.slice(1),o=(0,r.sprintf)((0,r.__)("Any %s","woocommerce"),e)),o))).join(", ");return n?o+t+n:o}const C=p((({products:e})=>e?u.NAMESPACE+`/products/${e}/variations`:u.NAMESPACE+"/variations"),(e=>({key:e.id,label:g(e)})))}}]);