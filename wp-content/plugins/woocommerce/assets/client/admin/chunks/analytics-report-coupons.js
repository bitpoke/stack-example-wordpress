"use strict";(globalThis.webpackChunk_wcAdmin_webpackJsonp=globalThis.webpackChunk_wcAdmin_webpackJsonp||[]).push([[4011],{1602:(e,o,t)=>{t.d(o,{O3:()=>l,be:()=>u,u8:()=>p});var r=t(65736),n=t(92694),c=t(9818),s=t(75606),a=t(20513);const{addCesSurveyForAnalytics:i}=(0,c.dispatch)(s.STORE_KEY),l=(0,n.applyFilters)("woocommerce_admin_coupons_report_charts",[{key:"orders_count",label:(0,r.__)("Discounted orders","woocommerce"),order:"desc",orderby:"orders_count",type:"number"},{key:"amount",label:(0,r.__)("Amount","woocommerce"),order:"desc",orderby:"amount",type:"currency"}]),u=(0,n.applyFilters)("woocommerce_admin_coupon_report_advanced_filters",{filters:{},title:(0,r._x)("Coupons match <select/> filters","A sentence describing filters for Coupons. See screen shot for context: https://cloudup.com/cSsUY9VeCVJ","woocommerce")}),m=[{label:(0,r.__)("All coupons","woocommerce"),value:"all"},{label:(0,r.__)("Single coupon","woocommerce"),value:"select_coupon",chartMode:"item-comparison",subFilters:[{component:"Search",value:"single_coupon",chartMode:"item-comparison",path:["select_coupon"],settings:{type:"coupons",param:"coupons",getLabels:a.hQ,labels:{placeholder:(0,r.__)("Type to search for a coupon","woocommerce"),button:(0,r.__)("Single Coupon","woocommerce")}}}]},{label:(0,r.__)("Comparison","woocommerce"),value:"compare-coupons",settings:{type:"coupons",param:"coupons",getLabels:a.hQ,labels:{title:(0,r.__)("Compare Coupon Codes","woocommerce"),update:(0,r.__)("Compare","woocommerce"),helpText:(0,r.__)("Check at least two coupon codes below to compare","woocommerce")},onClick:i}}];Object.keys(u.filters).length&&m.push({label:(0,r.__)("Advanced filters","woocommerce"),value:"advanced"});const p=(0,n.applyFilters)("woocommerce_admin_coupons_report_filters",[{label:(0,r.__)("Show","woocommerce"),staticParams:["chartType","paged","per_page"],param:"filter",showFilters:()=>!0,filters:m}])},93651:(e,o,t)=>{t.r(o),t.d(o,{default:()=>A});var r=t(69307),n=t(7862),c=t.n(n),s=t(65736),a=t(1602),i=t(92819),l=t(86020),u=t(10431),m=t(81595),p=t(81921),d=t(17844),_=t(42968),y=t(17062);class b extends r.Component{constructor(){super(),this.getHeadersContent=this.getHeadersContent.bind(this),this.getRowsContent=this.getRowsContent.bind(this),this.getSummary=this.getSummary.bind(this)}getHeadersContent(){return[{label:(0,s.__)("Coupon code","woocommerce"),key:"code",required:!0,isLeftAligned:!0,isSortable:!0},{label:(0,s.__)("Orders","woocommerce"),key:"orders_count",required:!0,defaultSort:!0,isSortable:!0,isNumeric:!0},{label:(0,s.__)("Amount discounted","woocommerce"),key:"amount",isSortable:!0,isNumeric:!0},{label:(0,s.__)("Created","woocommerce"),key:"created"},{label:(0,s.__)("Expires","woocommerce"),key:"expires"},{label:(0,s.__)("Type","woocommerce"),key:"type"}]}getRowsContent(e){const{query:o}=this.props,t=(0,u.getPersistedQuery)(o),n=(0,y.O3)("dateFormat",p.defaultTableDateFormat),{formatAmount:c,formatDecimal:a,getCurrencyConfig:d}=this.context;return(0,i.map)(e,(e=>{const{amount:o,coupon_id:i,orders_count:p}=e,_=e.extended_info||{},{code:y,date_created:b,date_expires:h,discount_type:g}=_,C=i>0?(0,u.getNewPath)(t,"/analytics/coupons",{filter:"single_coupon",coupons:i}):null,w=null===C?y:(0,r.createElement)(l.Link,{href:C,type:"wc-admin"},y),f=i>0?(0,u.getNewPath)(t,"/analytics/orders",{filter:"advanced",coupon_includes:i}):null;return[{display:w,value:y},{display:null===f?p:(0,r.createElement)(l.Link,{href:f,type:"wc-admin"},(0,m.formatValue)(d(),"number",p)),value:p},{display:c(o),value:a(o)},{display:b?(0,r.createElement)(l.Date,{date:b,visibleFormat:n}):(0,s.__)("N/A","woocommerce"),value:b},{display:h?(0,r.createElement)(l.Date,{date:h,visibleFormat:n}):(0,s.__)("N/A","woocommerce"),value:h},{display:this.getCouponType(g),value:g}]}))}getSummary(e){const{coupons_count:o=0,orders_count:t=0,amount:r=0}=e,{formatAmount:n,getCurrencyConfig:c}=this.context,a=c();return[{label:(0,s._n)("Coupon","Coupons",o,"woocommerce"),value:(0,m.formatValue)(a,"number",o)},{label:(0,s._n)("Order","Orders",t,"woocommerce"),value:(0,m.formatValue)(a,"number",t)},{label:(0,s.__)("Amount discounted","woocommerce"),value:n(r)}]}getCouponType(e){return{percent:(0,s.__)("Percentage","woocommerce"),fixed_cart:(0,s.__)("Fixed cart","woocommerce"),fixed_product:(0,s.__)("Fixed product","woocommerce")}[e]||(0,s.__)("N/A","woocommerce")}render(){const{advancedFilters:e,filters:o,isRequesting:t,query:n}=this.props;return(0,r.createElement)(_.Z,{compareBy:"coupons",endpoint:"coupons",getHeadersContent:this.getHeadersContent,getRowsContent:this.getRowsContent,getSummary:this.getSummary,summaryFields:["coupons_count","orders_count","amount"],isRequesting:t,itemIdField:"coupon_id",query:n,searchBy:"coupons",tableQuery:{orderby:n.orderby||"orders_count",order:n.order||"desc",extended_info:!0},title:(0,s.__)("Coupons","woocommerce"),columnPrefsKey:"coupons_report_columns",filters:o,advancedFilters:e})}}b.contextType=d.CurrencyContext;const h=b;var g=t(83573),C=t(47478),w=t(80272),f=t(31511);class v extends r.Component{getChartMeta(){const{query:e}=this.props,o="compare-coupons"===e.filter&&e.coupons&&e.coupons.split(",").length>1?"item-comparison":"time-comparison";return{itemsLabel:(0,s.__)("%d coupons","woocommerce"),mode:o}}render(){const{isRequesting:e,query:o,path:t}=this.props,{mode:n,itemsLabel:c}=this.getChartMeta(),s={...o};return"item-comparison"===n&&(s.segmentby="coupon"),(0,r.createElement)(r.Fragment,null,(0,r.createElement)(f.Z,{query:o,path:t,filters:a.u8,advancedFilters:a.be,report:"coupons"}),(0,r.createElement)(w.Z,{charts:a.O3,endpoint:"coupons",isRequesting:e,query:s,selectedChart:(0,g.Z)(o.chart,a.O3),filters:a.u8,advancedFilters:a.be}),(0,r.createElement)(C.Z,{charts:a.O3,filters:a.u8,advancedFilters:a.be,mode:n,endpoint:"coupons",path:t,query:s,isRequesting:e,itemsLabel:c,selectedChart:(0,g.Z)(o.chart,a.O3)}),(0,r.createElement)(h,{isRequesting:e,query:o,filters:a.u8,advancedFilters:a.be}))}}v.propTypes={query:c().object.isRequired};const A=v},86806:(e,o,t)=>{t.d(o,{I:()=>n});var r=t(65736);function n(e){return[e.country,e.state,e.name||(0,r.__)("TAX","woocommerce"),e.priority].map((e=>e.toString().toUpperCase().trim())).filter(Boolean).join("-")}},20513:(e,o,t)=>{t.d(o,{FI:()=>h,V1:()=>g,YC:()=>d,hQ:()=>_,jk:()=>y,oC:()=>b,qc:()=>p,uC:()=>C});var r=t(65736),n=t(96483),c=t(86989),s=t.n(c),a=t(92819),i=t(10431),l=t(67221),u=t(86806),m=t(17062);function p(e,o=a.identity){return function(t="",r){const c="function"==typeof e?e(r):e,a=(0,i.getIdsFromQuery)(t);if(a.length<1)return Promise.resolve([]);const l={include:a.join(","),per_page:a.length};return s()({path:(0,n.addQueryArgs)(c,l)}).then((e=>e.map(o)))}}p(l.NAMESPACE+"/products/attributes",(e=>({key:e.id,label:e.name})));const d=p(l.NAMESPACE+"/products/categories",(e=>({key:e.id,label:e.name}))),_=p(l.NAMESPACE+"/coupons",(e=>({key:e.id,label:e.code}))),y=p(l.NAMESPACE+"/customers",(e=>({key:e.id,label:e.name}))),b=p(l.NAMESPACE+"/products",(e=>({key:e.id,label:e.name}))),h=p(l.NAMESPACE+"/taxes",(e=>({key:e.id,label:(0,u.I)(e)})));function g({attributes:e,name:o}){const t=(0,m.O3)("variationTitleAttributesSeparator"," - ");if(o&&o.indexOf(t)>-1)return o;const n=(e||[]).map((({name:e,option:o})=>(o||(e=e.charAt(0).toUpperCase()+e.slice(1),o=(0,r.sprintf)((0,r.__)("Any %s","woocommerce"),e)),o))).join(", ");return n?o+t+n:o}const C=p((({products:e})=>e?l.NAMESPACE+`/products/${e}/variations`:l.NAMESPACE+"/variations"),(e=>({key:e.id,label:g(e)})))}}]);