"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Edit=void 0;const block_templates_1=require("@woocommerce/block-templates"),components_1=require("@woocommerce/components"),element_1=require("@wordpress/element"),i18n_1=require("@wordpress/i18n"),icons_1=require("@wordpress/icons"),text_control_1=require("../../../components/text-control"),validation_context_1=require("../../../contexts/validation-context"),use_product_edits_1=require("../../../hooks/use-product-edits"),use_product_entity_prop_1=__importDefault(require("../../../hooks/use-product-entity-prop"));function Edit({attributes:e,clientId:t,context:{postType:o}}){var i;const l=(0,block_templates_1.useWooBlockProps)(e),{property:n,label:r,placeholder:u,required:a,pattern:s,minLength:d,maxLength:c,min:_,max:m,help:v,tooltip:p,disabled:f,type:h,suffix:x}=e,[y,g]=(0,use_product_entity_prop_1.default)(n,{postType:o,fallbackValue:""}),{hasEdit:w}=(0,use_product_edits_1.useProductEdits)(),b=(0,element_1.useRef)(null),{error:q,validate:k}=(0,validation_context_1.useValidation)(n,(async function(){var e,o,i,l,n,r;if(!b.current)return;const u=b.current;let v="";return u.validity.typeMismatch&&(v=null!==(e=null==h?void 0:h.message)&&void 0!==e?e:(0,i18n_1.__)("Invalid value for the field.","woocommerce")),u.validity.valueMissing&&(v="string"==typeof a?a:(0,i18n_1.__)("This field is required.","woocommerce")),u.validity.patternMismatch&&(v=null!==(o=null==s?void 0:s.message)&&void 0!==o?o:(0,i18n_1.__)("Invalid value for the field.","woocommerce")),u.validity.tooShort&&(v=(0,i18n_1.sprintf)(null!==(i=null==d?void 0:d.message)&&void 0!==i?i:(0,i18n_1.__)("The minimum length of the field is %d","woocommerce"),null==d?void 0:d.value)),u.validity.tooLong&&(v=(0,i18n_1.sprintf)(null!==(l=null==c?void 0:c.message)&&void 0!==l?l:(0,i18n_1.__)("The maximum length of the field is %d","woocommerce"),null==c?void 0:c.value)),u.validity.rangeUnderflow&&(v=(0,i18n_1.sprintf)(null!==(n=null==_?void 0:_.message)&&void 0!==n?n:(0,i18n_1.__)("The minimum value of the field is %d","woocommerce"),null==_?void 0:_.value)),u.validity.rangeOverflow&&(v=(0,i18n_1.sprintf)(null!==(r=null==m?void 0:m.message)&&void 0!==r?r:(0,i18n_1.__)("The maximum value of the field is %d","woocommerce"),null==m?void 0:m.value)),u.setCustomValidity(v),u.validity.valid?void 0:{message:v,context:t}}),[h,a,s,d,c,_,m,y]);return(0,element_1.createElement)("div",{...l},(0,element_1.createElement)(text_control_1.TextControl,{ref:b,type:null!==(i=null==h?void 0:h.value)&&void 0!==i?i:"text",value:y,disabled:f,label:r,onChange:g,onBlur:()=>{w(n)&&k()},error:q,help:v,placeholder:u,tooltip:p,suffix:function(){if(!x||!y||!b.current)return;const e="url"===b.current.type&&!b.current.validity.typeMismatch;return!0===x&&e?(0,element_1.createElement)(components_1.Link,{type:"external",href:y,target:"_blank",rel:"noreferrer",className:"wp-block-woocommerce-product-text-field__suffix-link"},(0,element_1.createElement)(icons_1.Icon,{icon:icons_1.external,size:20})):"string"==typeof x?x:void 0}(),required:Boolean(a),pattern:null==s?void 0:s.value,minLength:null==d?void 0:d.value,maxLength:null==c?void 0:c.value,min:null==_?void 0:_.value,max:null==m?void 0:m.value}))}exports.Edit=Edit;