(()=>{var e,t={2396:(e,t,o)=>{"use strict";o.r(t);var r=o(9196);const n=window.wp.blocks;var l=o(2911),a=o(9425),s=o(5736),c=o(7608),i=o.n(c);const u=window.wp.blockEditor;o(2198);const p=({className:e,rating:t,ratedProductsCount:o})=>{const n=i()("wc-block-components-product-rating",e),l={width:t/5*100+"%"},a=(0,s.sprintf)(/* translators: %f is referring to the average rating value */ /* translators: %f is referring to the average rating value */
(0,s.__)("Rated %f out of 5","woocommerce"),t),c={__html:(0,s.sprintf)(/* translators: %s is the rating value wrapped in HTML strong tags. */ /* translators: %s is the rating value wrapped in HTML strong tags. */
(0,s.__)("Rated %s out of 5","woocommerce"),(0,s.sprintf)('<strong class="rating">%f</strong>',t))};return(0,r.createElement)("div",{className:n},(0,r.createElement)("div",{className:"wc-block-components-product-rating__stars",role:"img","aria-label":a},(0,r.createElement)("span",{style:l,dangerouslySetInnerHTML:c})),null!==o?(0,r.createElement)("span",{className:"wc-block-components-product-rating-count"},"(",o,")"):null)},d=window.wc.wcBlocksData,m=window.wp.data;var w=o(9307),g=o(9127),y=o.n(g);const _=(0,w.createContext)("page"),v=()=>(0,w.useContext)(_),b=(_.Provider,e=>{const t=v();e=e||t;const o=(0,m.useSelect)((t=>t(d.QUERY_STATE_STORE_KEY).getValueForQueryContext(e,void 0)),[e]),{setValueForQueryContext:r}=(0,m.useDispatch)(d.QUERY_STATE_STORE_KEY);return[o,(0,w.useCallback)((t=>{r(e,t)}),[e,r])]}),f=(e,t,o)=>{const r=v();o=o||r;const n=(0,m.useSelect)((r=>r(d.QUERY_STATE_STORE_KEY).getValueForQueryKey(o,e,t)),[o,e]),{setQueryValue:l}=(0,m.useDispatch)(d.QUERY_STATE_STORE_KEY);return[n,(0,w.useCallback)((t=>{l(o,e,t)}),[o,e,l])]};var E=o(2600);const h=window.wc.wcTypes;var S=o(4167);function k(e){const t=(0,w.useRef)(e);return y()(e,t.current)||(t.current=e),t.current}const C=({queryAttribute:e,queryPrices:t,queryStock:o,queryRating:r,queryState:n,isEditor:l=!1})=>{let a=v();a=`${a}-collection-data`;const[s]=b(a),[c,i]=f("calculate_attribute_counts",[],a),[u,p]=f("calculate_price_range",null,a),[g,y]=f("calculate_stock_status_counts",null,a),[_,C]=f("calculate_rating_counts",null,a),x=k(e||{}),T=k(t),O=k(o),P=k(r);(0,w.useEffect)((()=>{"object"==typeof x&&Object.keys(x).length&&(c.find((e=>(0,h.objectHasProp)(x,"taxonomy")&&e.taxonomy===x.taxonomy))||i([...c,x]))}),[x,c,i]),(0,w.useEffect)((()=>{u!==T&&void 0!==T&&p(T)}),[T,p,u]),(0,w.useEffect)((()=>{g!==O&&void 0!==O&&y(O)}),[O,y,g]),(0,w.useEffect)((()=>{_!==P&&void 0!==P&&C(P)}),[P,C,_]);const[N,R]=(0,w.useState)(l),[j]=(0,E.Nr)(N,200);N||R(!0);const q=(0,w.useMemo)((()=>(e=>{const t=e;return Array.isArray(e.calculate_attribute_counts)&&(t.calculate_attribute_counts=(0,S.DY)(e.calculate_attribute_counts.map((({taxonomy:e,queryType:t})=>({taxonomy:e,query_type:t})))).asc(["taxonomy","query_type"])),t})(s)),[s]);return(e=>{const{namespace:t,resourceName:o,resourceValues:r=[],query:n={},shouldSelect:l=!0}=e;if(!t||!o)throw new Error("The options object must have valid values for the namespace and the resource properties.");const a=(0,w.useRef)({results:[],isLoading:!0}),s=k(n),c=k(r),i=(()=>{const[,e]=(0,w.useState)();return(0,w.useCallback)((t=>{e((()=>{throw t}))}),[])})(),u=(0,m.useSelect)((e=>{if(!l)return null;const r=e(d.COLLECTIONS_STORE_KEY),n=[t,o,s,c],a=r.getCollectionError(...n);if(a){if(!(0,h.isError)(a))throw new Error("TypeError: `error` object is not an instance of Error constructor");i(a)}return{results:r.getCollection(...n),isLoading:!r.hasFinishedResolution("getCollection",n)}}),[t,o,c,s,l]);return null!==u&&(a.current=u),a.current})({namespace:"/wc/store/v1",resourceName:"products/collection-data",query:{...n,page:void 0,per_page:void 0,orderby:void 0,order:void 0,...q},shouldSelect:j})},x=window.wc.wcSettings,T=window.wc.blocksComponents,O=window.wp.components,P=[{label:(0,r.createElement)(p,{key:5,rating:5,ratedProductsCount:null}),value:"5"},{label:(0,r.createElement)(p,{key:4,rating:4,ratedProductsCount:null}),value:"4"},{label:(0,r.createElement)(p,{key:3,rating:3,ratedProductsCount:null}),value:"3"},{label:(0,r.createElement)(p,{key:2,rating:2,ratedProductsCount:null}),value:"2"},{label:(0,r.createElement)(p,{key:1,rating:1,ratedProductsCount:null}),value:"1"}],N=window.wp.url;(0,x.getSettingWithCoercion)("isRenderingPhpTemplate",!1,h.isBoolean);const R=(0,w.createContext)({}),j=({attributes:e,setAttributes:t})=>{const{showCounts:o,displayStyle:n,selectType:l}=e;return(0,r.createElement)(u.InspectorControls,{key:"inspector"},(0,r.createElement)(O.PanelBody,{title:(0,s.__)("Display Settings","woocommerce")},(0,r.createElement)(O.ToggleControl,{label:(0,s.__)("Display product count","woocommerce"),checked:o,onChange:()=>t({showCounts:!o})}),"dropdown"===n&&(0,r.createElement)(O.__experimentalToggleGroupControl,{label:(0,s.__)("Allow selecting multiple options?","woocommerce"),value:l||"multiple",onChange:e=>t({selectType:e}),className:"wc-block-attribute-filter__multiple-toggle"},(0,r.createElement)(O.__experimentalToggleGroupControlOption,{value:"multiple",label:(0,s._x)("Multiple","Number of filters","woocommerce")}),(0,r.createElement)(O.__experimentalToggleGroupControlOption,{value:"single",label:(0,s._x)("Single","Number of filters","woocommerce")})),(0,r.createElement)(O.__experimentalToggleGroupControl,{label:(0,s.__)("Display Style","woocommerce"),value:n,onChange:e=>t({displayStyle:e}),className:"wc-block-attribute-filter__display-toggle"},(0,r.createElement)(O.__experimentalToggleGroupControlOption,{value:"list",label:(0,s.__)("List","woocommerce")}),(0,r.createElement)(O.__experimentalToggleGroupControlOption,{value:"dropdown",label:(0,s.__)("Dropdown","woocommerce")}))))},q=({placeholder:e})=>(0,r.createElement)("div",{className:"wc-interactivity-dropdown"},(0,r.createElement)("div",{className:"wc-interactivity-dropdown__dropdown"},(0,r.createElement)("div",{className:"wc-interactivity-dropdown__dropdown-selection",tabIndex:0},(0,r.createElement)("span",{className:"wc-interactivity-dropdown__placeholder"},e),(0,r.createElement)("span",{className:"wc-interactivity-dropdown__svg-container"},(0,r.createElement)("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30"},(0,r.createElement)("path",{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"}))))));o(6765);const A=()=>(0,r.createElement)(O.Notice,{status:"warning",isDismissible:!1},(0,r.createElement)("p",null,(0,s.__)("Your store doesn't have any products with ratings yet. This filter option will display when a product receives a review.","woocommerce"))),D=(0,O.withSpokenMessages)((e=>{const t=e.attributes,o=(0,u.useBlockProps)(),n=(()=>{const{wrapper:e}=(0,w.useContext)(R);return t=>{e&&e.current&&(e.current.hidden=!t)}})(),[l]=b(),{results:a,isLoading:c}=C({queryRating:!0,queryState:l,isEditor:!0}),[d,m]=(0,w.useState)(t.isPreview?P:[]),g=!t.isPreview&&c&&0===d.length,y=!t.isPreview&&c,_=(0,w.useMemo)((()=>((e="filter_rating")=>{const t=(o=e,window?(0,N.getQueryArg)(window.location.href,o):null);var o;return t?(0,h.isString)(t)?t.split(","):t:[]})("rating_filter")),[]),[v]=(0,w.useState)(_),[E]=f("rating",_),[S,k]=(0,w.useState)(!1);return(0,w.useEffect)((()=>{if(c||t.isPreview)return;const e=!c&&(0,h.objectHasProp)(a,"rating_counts")&&Array.isArray(a.rating_counts)?[...a.rating_counts].reverse():[];if(0===e.length)return m(P),void k(!0);const o=e.filter((e=>(0,h.isObject)(e)&&Object.keys(e).length>0)).map((e=>{var o;return{label:(0,r.createElement)(p,{key:null==e?void 0:e.rating,rating:null==e?void 0:e.rating,ratedProductsCount:t.showCounts?null==e?void 0:e.count:null}),value:null==e||null===(o=e.rating)||void 0===o?void 0:o.toString()}}));m(o)}),[t.showCounts,t.isPreview,a,c,E]),(c||0!==d.length)&&(0,x.getSettingWithCoercion)("hasFilterableProducts",!1,h.isBoolean)?(n(!0),(0,r.createElement)(r.Fragment,null,(0,r.createElement)(j,{...e}),(0,r.createElement)("div",{...o},(0,r.createElement)(O.Disabled,null,S&&(0,r.createElement)(A,null),(0,r.createElement)("div",{className:i()(`style-${t.displayStyle}`,{"is-loading":g})},"dropdown"===t.displayStyle?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(q,{placeholder:"single"===t.selectType?(0,s.__)("Select a rating","woocommerce"):(0,s.__)("Select ratings","woocommerce")})):(0,r.createElement)(T.CheckboxList,{options:d,checked:v,onChange:()=>{},isLoading:g,isDisabled:y})))))):(n(!1),null)})),L=JSON.parse('{"name":"woocommerce/product-filter-rating","version":"1.0.0","title":"Product Filter: Rating (Beta)","description":"Enable customers to filter the product collection by rating.","category":"woocommerce","keywords":["WooCommerce"],"supports":{"interactivity":true,"inserter":false,"color":{"background":false,"text":true}},"ancestor":["woocommerce/product-filter"],"usesContext":["query","queryId"],"attributes":{"className":{"type":"string","default":""},"showCounts":{"type":"boolean","default":false},"displayStyle":{"type":"string","default":"list"},"selectType":{"type":"string","default":"multiple"},"isPreview":{"type":"boolean","default":false}},"textdomain":"woocommerce","apiVersion":2,"$schema":"https://schemas.wp.org/trunk/block.json"}');(0,n.registerBlockType)(L,{icon:{src:(0,r.createElement)(l.Z,{icon:a.Z,className:"wc-block-editor-components-block-icon"})},attributes:{...L.attributes},edit:D})},2198:()=>{},6765:()=>{},9196:e=>{"use strict";e.exports=window.React},9307:e=>{"use strict";e.exports=window.wp.element},5736:e=>{"use strict";e.exports=window.wp.i18n},9127:e=>{"use strict";e.exports=window.wp.isShallowEqual},444:e=>{"use strict";e.exports=window.wp.primitives}},o={};function r(e){var n=o[e];if(void 0!==n)return n.exports;var l=o[e]={exports:{}};return t[e].call(l.exports,l,l.exports,r),l.exports}r.m=t,e=[],r.O=(t,o,n,l)=>{if(!o){var a=1/0;for(u=0;u<e.length;u++){for(var[o,n,l]=e[u],s=!0,c=0;c<o.length;c++)(!1&l||a>=l)&&Object.keys(r.O).every((e=>r.O[e](o[c])))?o.splice(c--,1):(s=!1,l<a&&(a=l));if(s){e.splice(u--,1);var i=n();void 0!==i&&(t=i)}}return t}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[o,n,l]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.j=845,(()=>{var e={845:0};r.O.j=t=>0===e[t];var t=(t,o)=>{var n,l,[a,s,c]=o,i=0;if(a.some((t=>0!==e[t]))){for(n in s)r.o(s,n)&&(r.m[n]=s[n]);if(c)var u=c(r)}for(t&&t(o);i<a.length;i++)l=a[i],r.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return r.O(u)},o=self.webpackChunkwebpackWcBlocksMainJsonp=self.webpackChunkwebpackWcBlocksMainJsonp||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var n=r.O(void 0,[2869],(()=>r(2396)));n=r.O(n),((this.wc=this.wc||{}).blocks=this.wc.blocks||{})["product-filter-rating"]=n})();