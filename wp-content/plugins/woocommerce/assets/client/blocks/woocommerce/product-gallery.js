import*as e from"@wordpress/interactivity";var t={d:(e,o)=>{for(var r in o)t.o(o,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const o=(c={getConfig:()=>e.getConfig,getContext:()=>e.getContext,getElement:()=>e.getElement,store:()=>e.store,withScope:()=>e.withScope},l={},t.d(l,c),l),r=e=>{if(!e)return{top:!1,bottom:!1,left:!1,right:!1};const{scrollTop:t,scrollHeight:o,clientHeight:r,scrollLeft:n,scrollWidth:i,clientWidth:s}=e;return{top:t>3,bottom:t+r<o-3,left:n>3,right:n+s<i-3}},n=e=>(0,o.getContext)(e),{state:i}=(0,o.store)("woocommerce/product-data",{},{lock:"I acknowledge that using a private store means my plugin will inevitably break on the next store release."}),s={state:{get imageIndex(){const{imageData:e,selectedImageId:t}=n();return e.indexOf(t)}},actions:{selectImage:e=>{const t=n(),{imageData:r}=t,i=r[e],{isDisabledPrevious:s,isDisabledNext:a}={isDisabledPrevious:0===(c=e),isDisabledNext:c===r.length-1};var c;t.isDisabledPrevious=s,t.isDisabledNext=a,t.selectedImageId=i,-1!==i&&((e=>{if(!e)return;const t=(0,o.getElement)()?.ref;if(!t)return;const r=t.closest(".wp-block-woocommerce-product-gallery");if(!r)return;const n=r.querySelector(".wc-block-product-gallery-large-image__container");if(!n)return;const i=n.querySelector(`img[data-image-id="${e}"]`);if(i){const e=n.getBoundingClientRect(),t=i.getBoundingClientRect(),o=n.scrollLeft+(t.left-e.left)-(e.width-t.width)/2;n.scrollTo({left:o,behavior:"smooth"})}})(i),(e=>{if(!e)return;const t=(0,o.getElement)()?.ref;if(!t)return;const r=t.closest(".wp-block-woocommerce-product-gallery");if(!r)return;const n=r.querySelector(`.wc-block-product-gallery-thumbnails__thumbnail img[data-image-id="${e}"]`);if(!n)return;const i=n.closest(".wc-block-product-gallery-thumbnails__scrollable");if(!i)return;const s=n.closest(".wc-block-product-gallery-thumbnails__thumbnail");if(!s)return;const a=i.getBoundingClientRect(),c=s.getBoundingClientRect(),l=i.scrollTop+(c.top-a.top)-(a.height-c.height)/2,g=i.scrollLeft+(c.left-a.left)-(a.width-c.width)/2;i.scrollTo({top:l,left:g,behavior:"smooth"})})(i))},selectCurrentImage:e=>{e&&e.stopPropagation();const t=(0,o.getElement)()?.ref;if(!t)return;const r=t.getAttribute("data-image-id");if(!r)return;const i=parseInt(r,10),{imageData:s}=n(),c=s.indexOf(i);a.selectImage(c)},selectNextImage:e=>{e&&e.stopPropagation();const{imageData:t,selectedImageId:o}=n(),r=t.indexOf(o),i=Math.min(t.length-1,r+1);a.selectImage(i)},selectPreviousImage:e=>{e&&e.stopPropagation();const{imageData:t,selectedImageId:o}=n(),r=t.indexOf(o),i=Math.max(0,r-1);a.selectImage(i)},onViewerImageKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(" "===e.key&&e.preventDefault(),a.openDialog()),"ArrowRight"===e.key&&a.selectNextImage(),"ArrowLeft"===e.key&&a.selectPreviousImage()},onDialogKeyDown:e=>{if("Escape"===e.key&&a.closeDialog(),"Tab"===e.key){const t='a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex]:not([tabindex="-1"])',r=(0,o.getElement)()?.ref,n=r.querySelectorAll(t);if(!n.length)return;const i=n[0],s=n[n.length-1];if(!e.shiftKey&&e.target===s)return e.preventDefault(),void i.focus();if(e.shiftKey&&e.target===i)return e.preventDefault(),void s.focus();e.target===r&&(e.preventDefault(),i.focus())}},openDialog:()=>{n().isDialogOpen=!0,document.body.classList.add("wc-block-product-gallery-dialog-open")},closeDialog:()=>{n().isDialogOpen=!1,document.body.classList.remove("wc-block-product-gallery-dialog-open")},onTouchStart:e=>{const t=n(),{clientX:o}=e.touches[0];t.touchStartX=o,t.touchCurrentX=o,t.isDragging=!0},onTouchMove:e=>{const t=n();if(!t.isDragging)return;const{clientX:o}=e.touches[0];t.touchCurrentX=o;const r=o-t.touchStartX;Math.abs(r)>10&&e.preventDefault()},onTouchEnd:()=>{const e=n();if(!e.isDragging)return;const t=e.touchCurrentX-e.touchStartX,r=(0,o.getElement)()?.ref,i=r?.offsetWidth||0;Math.abs(t)>.2*i&&(t>0&&!e.isDisabledPrevious?a.selectPreviousImage():t<0&&!e.isDisabledNext&&a.selectNextImage()),e.isDragging=!1,e.touchStartX=0,e.touchCurrentX=0},onScroll:()=>{const e=(0,o.getElement)()?.ref;if(!e)return;const t=n(),i=r(e);t.thumbnailsOverflow=i},onArrowsKeyDown:e=>{"ArrowRight"===e.key&&(e.preventDefault(),a.selectNextImage()),"ArrowLeft"===e.key&&(e.preventDefault(),a.selectPreviousImage())},onThumbnailsArrowsKeyDown:e=>{a.onArrowsKeyDown(e);const t=(0,o.getElement)()?.ref,{selectedImageId:r}=n();if(t){const e=t.closest(".wp-block-woocommerce-product-gallery");if(e){const t=e.querySelector(`img[data-image-id="${r}"]`);t&&t.focus({preventScroll:!0})}}},onClickPrevious:e=>{a.selectPreviousImage(e)},onClickNext:e=>{a.selectNextImage(e)},onKeyDownPrevious:e=>{a.onArrowsKeyDown(e)},onKeyDownNext:e=>{a.onArrowsKeyDown(e)}},callbacks:{listenToProductDataChanges:()=>{const e=i?.productId;if(!e)return;const{products:t}=(0,o.getConfig)("woocommerce"),r=t?.[e]?.variations?.[i?.variationId||0]||t?.[e],s=r?.image_id;if(!s)return;const{imageData:c}=n(),l=c.indexOf(s);l>=0&&a.selectImage(l)},watchForChangesOnAddToCartForm:()=>{const e=n(),t=document.querySelector(`form[data-product_id="${e.productId}"]`);if(!t)return;const r=()=>(0,o.withScope)((()=>a.selectImage(0))),i=new MutationObserver((0,o.withScope)((function(e){for(const t of e){const{imageData:e}=n(),o=t.target.getAttribute("current-image"),r=o?parseInt(o,10):null;if("attributes"===t.type&&r&&e.includes(r)){const t=e.indexOf(r);a.selectImage(t)}else a.selectImage(0)}})));i.observe(t,{attributes:!0});const s=document.querySelector(".wp-block-add-to-cart-form .reset_variations");return s&&s.addEventListener("click",r),()=>{i.disconnect(),document.removeEventListener("click",r)}},dialogStateChange:()=>{const{selectedImageId:e,isDialogOpen:t}=n(),{ref:r}=(0,o.getElement)()||{};if(t&&r instanceof HTMLElement){r.focus();const t=r.querySelector(`[data-image-id="${e}"]`);t instanceof HTMLElement&&t.parentNode instanceof HTMLElement&&(t.parentNode.scrollTop=t.offsetTop+t.offsetHeight/2-r.offsetHeight/2-32)}},toggleActiveThumbnailAttributes:()=>{const e=(0,o.getElement)()?.ref;if(!e)return!1;const t=e.getAttribute("data-image-id");if(!t)return!1;const{selectedImageId:r}=n();r===Number(t)?(e.classList.add("wc-block-product-gallery-thumbnails__thumbnail__image--is-active"),e.setAttribute("tabIndex","0")):(e.classList.remove("wc-block-product-gallery-thumbnails__thumbnail__image--is-active"),e.setAttribute("tabIndex","-1"))},initResizeObserver:()=>{const e=(0,o.getElement)()?.ref;if(!e)return;const t=n(),i=new ResizeObserver((()=>{const o=r(e);t.thumbnailsOverflow=o}));return i.observe(e),e.parentElement&&i.observe(e.parentElement),()=>{i.disconnect()}},hideGhostOverflow:()=>{const e=(0,o.getElement)()?.ref;if(!e)return;const{clientWidth:t,scrollWidth:r}=e;t>=r&&(e.style.scrollbarWidth="none")}}},{actions:a}=(0,o.store)("woocommerce/product-gallery",s,{lock:!0});var c,l;